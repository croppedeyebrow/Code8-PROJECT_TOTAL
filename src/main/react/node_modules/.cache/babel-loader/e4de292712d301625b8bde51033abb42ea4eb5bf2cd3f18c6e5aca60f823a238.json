{"ast":null,"code":"import React,{useEffect,useRef,useState}from\"react\";import{loadPaymentWidget}from\"@tosspayments/payment-widget-sdk\";import{PayBox,PerformanceButton,RadioButton}from\"../../style/MyPageStyle\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";const clientKey=\"test_ck_26DlbXAaV01OJX6EbLN5rqY50Q9R\";const customerKey=\"test_sk_5OWRapdA8dJwzRlXG1yRVo1zEqZK\";export const PayComponent=_ref=>{let{email,username,phone}=_ref;const[price,setPrice]=useState(100);const requestPayment=async()=>{const paymentWidget=paymentWidgetRef.current;try{// ------ '결제하기' 버튼 누르면 결제창 띄우기 ------\nconsole.log(paymentWidget);await(paymentWidget===null||paymentWidget===void 0?void 0:paymentWidget.requestPayment({orderId:\"p93WFPeu_ZS9--L7wNdca\",orderName:\"포인트충전\",customerName:username,customerEmail:email,customerMobilePhone:phone,successUrl:\"\".concat(window.location.origin,\"/success?username=\").concat(username,\"&email=\").concat(email,\"&phone=\").concat(phone),failUrl:\"\".concat(window.location.origin,\"/fail\")}));}catch(error){// 에러 처리하기\nconsole.error(error);}};const paymentWidgetRef=useRef(null);const paymentMethodsWidgetRef=useRef(null);useEffect(()=>{// setParamPrice(Price);\n(async()=>{// ------  결제위젯 초기화 ------\nconst paymentWidget=await loadPaymentWidget(clientKey,customerKey);// 회원 결제\n// ------  결제 UI 렌더링 ------\nconst paymentMethodsWidget=paymentWidget.renderPaymentMethods(\"#payment-widget\",{value:price},{variantKey:\"DEFAULT\"});// ------  이용약관 UI 렌더링 ------\npaymentWidget.renderAgreement(\"#agreement\",{variantKey:\"AGREEMENT\"}// 기본 이용약관 UI 렌더링\n);paymentWidgetRef.current=paymentWidget;paymentMethodsWidgetRef.current=paymentMethodsWidget;})();},[price]);useEffect(()=>{const paymentMethodsWidget=paymentMethodsWidgetRef.current;if(paymentMethodsWidget==null){return;}console.log(email);console.log(price);// ------ 금액 업데이트 ------\npaymentMethodsWidget.updateAmount(price);},[price]);return/*#__PURE__*/_jsxs(PayBox,{children:[/*#__PURE__*/_jsx(\"h1\",{children:\"\\uCDA9\\uC804\\uD558\\uAE30\"}),/*#__PURE__*/_jsx(\"span\",{children:\"\".concat(price.toLocaleString(),\"\\uC6D0\")}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(RadioButton,{id:\"1000\",name:\"charge\",value:\"1000\",className:price===1000?\"checked\":\"\",onClick:()=>setPrice(1000),children:\"1,000\\uC6D0\"}),/*#__PURE__*/_jsx(RadioButton,{id:\"5000\",name:\"charge\",value:\"5000\",className:price===5000?\"checked\":\"\",onClick:()=>setPrice(5000),children:\"5,000\\uC6D0\"}),/*#__PURE__*/_jsx(RadioButton,{id:\"10000\",name:\"charge\",value:\"10000\",className:price===10000?\"checked\":\"\",onClick:()=>setPrice(10000),children:\"10,000\\uC6D0\"})]})}),/*#__PURE__*/_jsx(\"div\",{id:\"payment-widget\"}),/*#__PURE__*/_jsx(\"div\",{id:\"agreement\"}),/*#__PURE__*/_jsx(PerformanceButton,{onClick:requestPayment,children:\"\\uACB0\\uC81C\\uD558\\uAE30\"})]});};export default PayComponent;","map":{"version":3,"names":["React","useEffect","useRef","useState","loadPaymentWidget","PayBox","PerformanceButton","RadioButton","jsx","_jsx","jsxs","_jsxs","clientKey","customerKey","PayComponent","_ref","email","username","phone","price","setPrice","requestPayment","paymentWidget","paymentWidgetRef","current","console","log","orderId","orderName","customerName","customerEmail","customerMobilePhone","successUrl","concat","window","location","origin","failUrl","error","paymentMethodsWidgetRef","paymentMethodsWidget","renderPaymentMethods","value","variantKey","renderAgreement","updateAmount","children","toLocaleString","id","name","className","onClick"],"sources":["C:/dev/PROJECT_TOTAL/src/main/react/src/component/Mypage/PayComponent.tsx"],"sourcesContent":["import React, { useEffect, useRef, useState } from \"react\";\r\nimport {\r\n  PaymentWidgetInstance,\r\n  loadPaymentWidget,\r\n  ANONYMOUS,\r\n} from \"@tosspayments/payment-widget-sdk\";\r\nimport {\r\n  PayBox,\r\n  PerformanceButton,\r\n  RadioButton,\r\n} from \"../../style/MyPageStyle\";\r\nconst clientKey = \"test_ck_26DlbXAaV01OJX6EbLN5rqY50Q9R\";\r\nconst customerKey = \"test_sk_5OWRapdA8dJwzRlXG1yRVo1zEqZK\";\r\n\r\nexport const PayComponent = ({ email, username, phone }) => {\r\n  const [price, setPrice] = useState(100);\r\n\r\n  const requestPayment = async () => {\r\n    const paymentWidget = paymentWidgetRef.current;\r\n\r\n    try {\r\n      // ------ '결제하기' 버튼 누르면 결제창 띄우기 ------\r\n      console.log(paymentWidget);\r\n      await paymentWidget?.requestPayment({\r\n        orderId: \"p93WFPeu_ZS9--L7wNdca\",\r\n        orderName: \"포인트충전\",\r\n        customerName: username,\r\n        customerEmail: email,\r\n        customerMobilePhone: phone,\r\n        successUrl: `${window.location.origin}/success?username=${username}&email=${email}&phone=${phone}`,\r\n        failUrl: `${window.location.origin}/fail`,\r\n      });\r\n    } catch (error) {\r\n      // 에러 처리하기\r\n      console.error(error);\r\n    }\r\n  };\r\n\r\n  const paymentWidgetRef = useRef<PaymentWidgetInstance | null>(null);\r\n  const paymentMethodsWidgetRef = useRef<ReturnType<\r\n    PaymentWidgetInstance[\"renderPaymentMethods\"]\r\n  > | null>(null);\r\n\r\n  useEffect(() => {\r\n    // setParamPrice(Price);\r\n    (async () => {\r\n      // ------  결제위젯 초기화 ------\r\n      const paymentWidget = await loadPaymentWidget(clientKey, customerKey); // 회원 결제\r\n\r\n      // ------  결제 UI 렌더링 ------\r\n      const paymentMethodsWidget = paymentWidget.renderPaymentMethods(\r\n        \"#payment-widget\",\r\n        { value: price },\r\n        { variantKey: \"DEFAULT\" }\r\n      );\r\n\r\n      // ------  이용약관 UI 렌더링 ------\r\n      paymentWidget.renderAgreement(\r\n        \"#agreement\",\r\n        { variantKey: \"AGREEMENT\" } // 기본 이용약관 UI 렌더링\r\n      );\r\n      paymentWidgetRef.current = paymentWidget;\r\n      paymentMethodsWidgetRef.current = paymentMethodsWidget;\r\n    })();\r\n  }, [price]);\r\n\r\n  useEffect(() => {\r\n    const paymentMethodsWidget = paymentMethodsWidgetRef.current;\r\n\r\n    if (paymentMethodsWidget == null) {\r\n      return;\r\n    }\r\n    console.log(email);\r\n    console.log(price);\r\n    // ------ 금액 업데이트 ------\r\n    paymentMethodsWidget.updateAmount(price);\r\n  }, [price]);\r\n\r\n  return (\r\n    <PayBox>\r\n      <h1>충전하기</h1>\r\n      <span>{`${price.toLocaleString()}원`}</span>\r\n      <div>\r\n        <div>\r\n          <RadioButton\r\n            id=\"1000\"\r\n            name=\"charge\"\r\n            value=\"1000\"\r\n            className={price === 1000 ? \"checked\" : \"\"}\r\n            onClick={() => setPrice(1000)}\r\n          >\r\n            1,000원\r\n          </RadioButton>\r\n          <RadioButton\r\n            id=\"5000\"\r\n            name=\"charge\"\r\n            value=\"5000\"\r\n            className={price === 5000 ? \"checked\" : \"\"}\r\n            onClick={() => setPrice(5000)}\r\n          >\r\n            5,000원\r\n          </RadioButton>\r\n          <RadioButton\r\n            id=\"10000\"\r\n            name=\"charge\"\r\n            value=\"10000\"\r\n            className={price === 10000 ? \"checked\" : \"\"}\r\n            onClick={() => setPrice(10000)}\r\n          >\r\n            10,000원\r\n          </RadioButton>\r\n        </div>\r\n      </div>\r\n      <div id=\"payment-widget\" />\r\n      <div id=\"agreement\" />\r\n      <PerformanceButton onClick={requestPayment}>결제하기</PerformanceButton>\r\n    </PayBox>\r\n  );\r\n};\r\nexport default PayComponent;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}